<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>グラビア印刷トレーニング</title>
  <link rel="stylesheet" href="./styles.css?v=20250809f">
</head>
<body>
<header class="topbar">
  <div class="brand">グラビア印刷トレーニング</div>
  <div id="stats" class="stats">読み込み中…</div>
</header>

<main>
  <nav class="nav">
    <button id="btn-train"    data-tab="train"    class="active">トレーニング</button>
    <button id="btn-glossary" data-tab="glossary">用語集</button>
    <button id="btn-diagram"  data-tab="diagram">図式</button>
    <button id="btn-handbook" data-tab="handbook">参考書</button>
  </nav>

  <section id="tab-train">
    <div class="panel">
      <h2>トレーニング</h2>
      <div class="row">
        <label>出題モード
          <select id="mode">
            <option value="any">指定しない</option>
            <option value="wrong">復習（間違えた問題のみ）</option>
            <option value="weak">苦手順優先</option>
          </select>
        </label>

        <label>カテゴリ
          <select id="catFilter">
            <option value="any">指定しない</option>
            <option value="技術">技術</option>
            <option value="営業実務">営業実務</option>
          </select>
        </label>

        <label>難易度
          <select id="difficulty">
            <option value="any">指定しない</option>
            <option value="low">低</option>
            <option value="mid">中</option>
            <option value="high">高</option>
          </select>
        </label>

        <label>出題数
          <select id="countPreset">
            <option value="15">15問</option>
            <option value="30">30問</option>
            <option value="50">50問</option>
            <option value="100">100問</option>
          </select>
        </label>

        <button id="start" class="btn primary">開始</button>
        <button id="resume" class="btn secondary" title="一時保存から再開">再開</button>
        <button id="save" class="btn secondary" title="途中保存して後で続きます">一時保存</button>
        <button id="resetSession" class="btn danger" title="保存中のセッションを消去">保存削除</button>
      </div>
      <div id="progress" class="progress"><div class="bar" style="width:0%"></div></div>
    </div>

    <div id="game" class="stack"></div>
  </section>

  <section id="tab-glossary" hidden>
    <div class="panel">
      <h2>用語集</h2>
      <div class="row">
        <input id="gSearch" class="input grow" placeholder="用語・説明で検索">
        <select id="gCat" class="input"></select>
        <div id="gCount" class="muted">0 語</div>
      </div>
      <ul id="gList" class="terms"></ul>
      <div id="gDetail" class="panel" hidden></div>
    </div>
  </section>

  <section id="tab-diagram" hidden>
    <div class="panel">
      <h2>図式モード（入稿 → 色校正 → 製版 → 実機刷り）</h2>
      <div class="diagram-card">
        <svg viewBox="0 0 960 420" class="diagram-svg" role="img" aria-label="gravure flow">
          <defs>
            <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z"></path>
            </marker>
            <style>
              .bx{rx:14; ry:14; fill:#0b1220; stroke:#334155; stroke-width:2}
              .tx{font: 600 14px/1.3 system-ui, -apple-system, "Noto Sans JP", sans-serif; fill:#e5e7eb}
              .sub{font: 12px system-ui, -apple-system, "Noto Sans JP", sans-serif; fill:#9ca3af}
              .ln{stroke:#22c55e; stroke-width:3; marker-end:url(#arrow)}
              @media (prefers-color-scheme: light){
                .bx{fill:#ffffff; stroke:#cbd5e1}
                .tx{fill:#0f172a} .sub{fill:#64748b}
              }
            </style>
          </defs>

          <g class="node" data-term="デザイン入稿">
            <rect class="bx" x="40"  y="60"  width="200" height="70"></rect>
            <text class="tx" x="140" y="90" text-anchor="middle">デザイン入稿</text>
            <text class="sub" x="140" y="110" text-anchor="middle">データ / プロファイル</text>
          </g>
          <g class="node" data-term="色校正">
            <rect class="bx" x="300" y="60"  width="200" height="70"></rect>
            <text class="tx" x="400" y="90" text-anchor="middle">色校正</text>
            <text class="sub" x="400" y="110" text-anchor="middle">標準見本 / ΔE / D50</text>
          </g>
          <g class="node" data-term="グラビア版">
            <rect class="bx" x="560" y="60"  width="200" height="70"></rect>
            <text class="tx" x="660" y="90" text-anchor="middle">製版 / 版</text>
            <text class="sub" x="660" y="110" text-anchor="middle">セル / 線数 / 彫刻</text>
          </g>
          <g class="node" data-term="刷り出し確認">
            <rect class="bx" x="820" y="60"  width="100" height="70"></rect>
            <text class="tx" x="870" y="90" text-anchor="middle">実機刷り</text>
            <text class="sub" x="870" y="110" text-anchor="middle">条件最適 / QA</text>
          </g>
          <line class="ln" x1="240" y1="95" x2="300" y2="95"/>
          <line class="ln" x1="500" y1="95" x2="560" y2="95"/>
          <line class="ln" x1="760" y1="95" x2="820" y2="95"/>
          <g class="node" data-term="白引き">
            <rect class="bx" x="120" y="240" width="160" height="60"></rect>
            <text class="tx" x="200" y="268" text-anchor="middle">白引き</text>
          </g>
          <g class="node" data-term="レジスター">
            <rect class="bx" x="360" y="240" width="160" height="60"></rect>
            <text class="tx" x="440" y="268" text-anchor="middle">見当 / レジ</text>
          </g>
          <g class="node" data-term="乾燥不良">
            <rect class="bx" x="600" y="240" width="200" height="60"></rect>
            <text class="tx" x="700" y="268" text-anchor="middle">乾燥 / 残留溶剤</text>
          </g>
          <line class="ln" x1="280" y1="270" x2="360" y2="270"/>
          <line class="ln" x1="520" y1="270" x2="600" y2="270"/>
          <line class="ln" x1="240" y1="240" x2="340" y2="130"/>
        </svg>
        <div class="diagram-hint">ボックスをタップすると該当用語ページへ移動します</div>
      </div>
    </div>
  </section>

  <section id="tab-handbook" hidden>
    <div class="panel">
      <h2>参考書</h2>
      <div class="row">
        <select id="hbChapter" class="input"></select>
        <select id="hbSection" class="input"></select>
      </div>
      <div id="hbContent" class="handbook"></div>
    </div>
  </section>

</main>
<script type="module" src="./src/main.js?v=20250809z"></script>
</body>
</html>
